<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.situ.jingbao.dao.admin.AdminUserDAO">
    <!--根据班级编号查询班级-->
    <select id="findByUsername" resultType="AdminUser" parameterType="java.lang.String">
        select id, username, password
        from t_admin_user
        where username = #{username}
    </select>

    <select id="findAll" resultType="AdminUser" parameterType="AdminUserSearchBean">
        select id,
        username,
        password,
        sex,
        phone,
        mobile,
        email,
        address,
        created_time,
        state
        from t_admin_user
        <where>
            <if test="ausb.createdDate != null">
                and convert(created_time,date) = #{createdDate}
            </if>
            <if test="ausb.keyword != null and ausb.keyword != ''">
                <bind name="k" value="'%'+ausb.keyword+'%'"/>
                and (
                username like #{k} or email like #{k} or mobile like #{k}
                )
            </if>
        </where>
        order by id
    </select>

    <delete id="deleteByIds">
        delete from t_admin_user
        where id in
        <foreach collection="ids" open="(" close=")" separator="," item="id">
            #{id}
        </foreach>
    </delete>

    <!--保存用户-->
    <insert id="save" parameterType="AdminUser">
        insert into t_admin_user (username, password, sex, phone, mobile, email, address, created_time, state)
        values (#{username}, #{password}, #{sex}, #{phone}, #{mobile}, #{email}, #{address}, #{createdTime}, #{state})
    </insert>

    <update id="update" parameterType="AdminUser">
        update t_admin_user
        set username = #{username},
            password = #{password},
            sex      = #{sex},
            phone    = #{phone},
            mobile   = #{mobile},
            email=#{email},
            address  = #{address},
            state    = #{state}
        where id = #{id}
    </update>

    <!--修改状态-->
    <update id="updateState">
        update t_admin_user
        set state = #{state}
        where id = #{id}
    </update>


</mapper>